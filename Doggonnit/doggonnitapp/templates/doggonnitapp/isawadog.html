<head>
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.2/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.2/mapbox-gl.css' rel='stylesheet'/>

</head>

<style>
    div{
        padding-top: 5px;
    }

    img{
        width: 250px;
        height: 250px;
    }
</style>

<h1>I saw a lost dog</h1>
<h2>This is where the dog was, and what it looked like</h2>

<div id='map' style='width: 600px; height: 500px;'></div>
    <script>
        mapboxgl.accessToken = '{{ mapbox_api_key }}';
        let map = new mapboxgl.Map({
            container: 'map',
            style: 'mapbox://styles/mapbox/streets-v9',
            center: [-122.667, 45.523],
            zoom: 10
        });
        map.addControl(new mapboxgl.GeolocateControl({
            positionOptions: {
                enableHighAccuracy: true
            },
            trackUserLocation: true
        }));

        map.addControl(new mapboxgl.FullscreenControl());

        let nav = new mapboxgl.NavigationControl();
        map.addControl(nav, 'top-left');


        function new_lost_marker(x, y){
            let marker = new mapboxgl.Marker()
                .setLngLat([x, y])
                .addTo(map);
        }

//add markers on click
        marker_array = []
        map.on('click', function (e) {
            let lat = e.lngLat.lat;
            let lng = e.lngLat.lng;
            let marker = new_lost_marker(lng, lat)
            marker_array.push(marker)
        });

//attempt to remove markers, doesnt work
        function remove_markers(marker_array){
            for (marker in marker_array){
                map.removeLayer(marker)
            }
        }


//        map.on('click', remove_markers(marker_array))


    </script>



<div>
    <form action="{% url 'doggonnitapp:isawadog' %}" method="POST">
        {% csrf_token %}

        <div>
            <select name="age">
                <option selected disabled> Age </option>
                {% for age in ages %}
                    <option>{{age}}</option>
                {% endfor %}
            </select>

            <select name="weight">
                <option selected disabled> Size </option>
                {% for weight in weights %}
                    <option>{{weight}}</option>
                {% endfor %}
            </select>

            <select name="breed">
                <option selected disabled> Breed </option>
                {% for breed in breeds %}
                    <option>{{breed}}</option>
                {% endfor %}
            </select>

            <select name="color">
                <option selected disabled> Color </option>
                {% for color in colors %}
                    <option>{{color}}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <textarea rows="5" cols="75" placeholder="description" name="description"></textarea>
        </div>
        <button type="submit"> Submit </button>
    </form>
</div>